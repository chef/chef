---
driver:
  name: exec
  gui: false

transport:
  name: exec

provisioner:
  name: chef_infra
  product_name: chef
  # Use the binlinked chef-client from habitat package installed in workflow
  install_strategy: skip
  client_rb:
    diff_disabled: true
    always_dump_stacktrace: true
  deprecations_as_errors: true
  chef_license: accept-no-persist
  slow_resource_report: true

verifier:
  name: inspec
  format: progress

lifecycle:
  pre_converge:
    - remote: |
        Write-Host "Verifying chef-client from Habitat package:"
        chef-client --version
        if ($LASTEXITCODE -ne 0) {
            Write-Error "chef-client not available"
            Exit 1
        }

platforms:
  - name: windows-2022
  - name: windows-2025
