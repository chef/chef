expeditor:
  defaults:
    buildkite:
      timeout_in_minutes: 45

steps:
  - label: "habitat: linux plan"
    expeditor:
      executor:
        docker:
          privileged: true
          propagate-environment: true
          environment:
            - ARTIFACTORY_API_KEY
    commands:
      - sudo -E ./.expeditor/scripts/install-hab.sh 'x86_64-linux'
      - sudo ./.expeditor/scripts/verify-plan.sh

  - label: "habitat: windows plan"
    agents:
      queue: default-windows-2019-privileged
    env:
      - ARTIFACTORY_API_KEY
    commands:
      - ./.expeditor/scripts/verify-plan.ps1
